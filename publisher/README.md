# Скрипты публикации страницы нового эпизода на сайт, заливки файла подкаста во все места

## Как пользоваться скриптами в этой директории?

Перед использованием, необходимо собрать docker образ при помощи docker-compose (конфиг в руте репозитария), команда: `docker-compose build publisher`.

После сборки образа, скриптами публикации можно пользоваться как с помощью `make`:

- `make new` — создает шаблон нового выпуска, темы берутся с news.radio-t.com
- `make prep` — создает шаблон "Темы для ..." следующего выпуска
- `make print-mp3-tags EPISODE=685` - выводит mp3 теги файла эпизода подскаста
- `make upload-mp3 EPISODE=685` - добавляет mp3 теги и картинку в файл эпизода подкаста, после чего разносит его по нодам через внешний ansible контейнер. Для выполнения необходимо подключить в docker-compose конфиге директорию с mp3 файлами подкаста как volume в сервис publisher
- `make deploy` — добавляет в гит и запускает pull + build на мастер. После этого строит лог чата и очищает темы

## Для разработчика

После изменений python скриптов, желательно прогнать следующие линтеры и форматтеры:
 - `isort --lines 119 -y`
 - `black --line-length 120 --target-version py38 ./*/*.py`
 - `flake8 . --max-line-length=120`